<!DOCTYPE html>
<html lang="en">
  <head>
    <meta name="description" content ="CS88: Computational Structures in Data Science" />
    <meta name="keywords" content ="CS88, Computer Science, Data Science, Programming, Berkeley, EECS" />
    <meta name="author" content ="Michael Ball, Amir Shahatit, Alex Kassil, Lyric Yu, Julia Yu, Srinath Goli, Sophia Qin, Brian Mi, Alec Kan, John Yang" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
    <meta name="viewport" content="width=device-width">

    <link rel="stylesheet" href="/fa19/assets/css/bootstrap.min.css">
    <link rel="stylesheet" type="text/css" href="/fa19/assets/css/style.css">
    <link rel="icon" href="/fa19/assets/images/favicon.ico">
    <link rel="stylesheet" href="/fa19/assets/css/mono-blue.css">

    <link rel="stylesheet" type="text/css" href="/fa19/assets/css/resource.css" />
<link rel="stylesheet" type="text/css" href="/fa19/assets/css/hw.css"/>


    <title>Homework 12 | CS 88 Fall 2019</title>

  </head>

  <body id="index" class="home">
    <nav class="navbar navbar-default navbar-fixed-top">
      <div class="container">
        <!-- Brand and toggle get grouped for better mobile display -->
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar-collapse-section" aria-label="Toggle Nav Menu" aria-expanded="false">
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="/fa19/">CS 88</a>
        </div>

        <div class="collapse navbar-collapse" id="navbar-collapse-section">
          <ul class="nav navbar-nav navbar-right">
            <li><a href="/fa19/">Calendar</a></li>
            <li><a href="/fa19/articles/resources.html">Resources</a></li>
            <li><a href="/fa19/weekly-schedule.html">Weekly Schedule</a></li>
            <li><a href="/fa19/articles/about.html">Course Information</a></li>
            <li><a href="/fa19/staff.html">Staff</a></li>
            <!--- <li><a href="/fa19/tutoring.html">Tutoring</a></li> -->
          </ul>
        </div>
      </div>
    </nav>

    <div id="content" class="container">
      <div class='row'>
  <div class='col-md-9'>
    <div class='page-header'>
      <h1><span class="content-title-brand">Homework 12</span></h1>
    </div>

    <p><i>Due at 11:59:59 pm on 05/01/2019.</i></p>

<h2>Instructions</h2>

<p>Download <a href="hw12.zip"> hw12.zip</a>.
    Inside the archive, you will find starter files for the questions in this homework,
    along with a copy of the OK autograder.</p>

<p><strong>Submission:</strong> When you are done, submit with <code>python3 ok --submit</code>. You may submit more than once before the deadline; only the final submission will be scored. Check that you have successfully submitted your code on <a href="https://okpy.org">okpy.org</a>. See <a href="https://cs61a.org/articles/using-ok.html">this article</a> for more instructions on okpy and submitting assignments.</p>

<p><strong>Readings:</strong> This homework relies on following references:</p>

<ul>
  <li><a href="http://www.composingprograms.com/pages/43-declarative-programming.html">Section 4.3</a></li>
</ul>

    


<h2 id="iterators">Iterators</h2>


<p>Remember the <code>for</code> loop?  (We really hope so.)  The object the <code>for</code> loop
iterates over must be an iterable! An <strong>iterable</strong> is a way of representing
explicit sequences (like lists or strings) as well as <em>implicit</em> sequences (like
the natural numbers <code>1, 2, 3, ...</code>).</p>

<pre><code>for elem in iterable:
    # do something</code></pre>

<p><code>for</code> loops only work with iterables. This means the object you want to use a
<code>for</code> loop on must implement the <strong>iterable interface</strong>.  To implement the
iterable interface, an object must define an <code>__iter__</code> method that returns an
object that implements the <strong>iterator interface</strong>.  To implement the iterator
interface, an object must define a <code>__next__</code> method to compute and return the
next element in the sequence. If the iterator exhausts the sequence, it raises
<code>StopIteration</code> to send a signal to indicate that it reaches the end.</p>

<p>An iterable object can create an arbitrary amount of iterator objects. In
addition, the iterators are independent of each other; in other words they can
have a different position in the sequence.</p>

<p>Here is a table summarizing the required methods of the <em>iterable</em> and 
<em>iterator</em> interfaces/protocols. Python also has more
<a href="https://docs.python.org/3/library/stdtypes.html#typeiter">documentation</a>
about <a href="https://docs.python.org/3/glossary.html#term-iterator">iterator</a> types.</p>

<div class = "table-responsive">
  <table class='table table-bordered'>
    <tr>
      <th>Iterable</th>
      <th>Iterator</th>
    </tr>
    <tr>
      <td><code>__iter__</code>: return a new iterator</td>
      <td><code>__iter__</code>: must return itself</td>
    </tr>
    <tr>
      <td align="center"></td>
      <td><code>__next__</code>: return the next element,
      or raise <code>StopIteration</code></td>
    </tr>
  </table>
</div>

<p>In Python, an iterator must also be an iterable. In other words, it must have a
<code>__iter__</code> method that returns itself (with the current state unaltered).</p>

<p><strong>Analogy</strong>: an iterable is like a book (one can flip through the
pages) and an iterator is a bookmark (saves the position and can locate
the next page).  Calling <code>__iter__</code> on a book gives you a new bookmark
independent of other bookmarks, but calling <code>__iter__</code> on a bookmark
gives you the bookmark itself, without changing its position at all.</p>

<p>Here is an example of a class definition for an object that implements
the iterator interface:</p>

<pre><code>class AnIterator:
    def __init__(self):
        self.current = 0

    def __next__(self):
        if self.current &gt; 5:
            raise StopIteration
        self.current += 1
        return self.current

    def __iter__(self):
        return self</code></pre>

<p>Let's go ahead and try out our new toy.</p>

<pre><code>&gt;&gt;&gt; for num in AnIterator():
...     print(num)
1
2
3
4
5
6</code></pre>

<p>This is somewhat equivalent to running:</p>

<pre><code>t = AnIterator()
t = iter(t) # iter(t) is the same as t.__iter__()
try:
    while True:
        # next(t) is the same as t.__next__()
        print(next(t))
except StopIteration as e:
    pass</code></pre>

<h3 class="question" id="q1">Question 1: Restart</h3>

<blockquote><p>Use OK to test your knowledge with the following What would Python print
questions:</p>

<pre><code>python3 ok &#x2d;q restart &#x2d;u</code></pre></blockquote>

<p>Try this!</p>

<pre><code>&gt;&gt;&gt; iterator = IteratorA()
&gt;&gt;&gt; [num for num in iterator]</code></pre>

<p>Then again:</p>

<pre><code>&gt;&gt;&gt; [num for num in iterator]</code></pre>

<p>This happens because the instance variables are not reset
each time a <code>for</code> loop is started. Therefore, when a <code>StopIteration</code>
exception is raised at the end of the first for loop it certainly
will be raised immediately at the beginning of the second.
With that in mind, try writing an iterator that "restarts" every time
it is run through a <code>for</code> loop.</p>

<solution>

<pre><code>class IteratorRestart:
    &quot;&quot;&quot;
    &gt;&gt;&gt; iterator = IteratorRestart(2, 7)
    &gt;&gt;&gt; for num in iterator:
    ...     print(num)
    2
    3
    4
    5
    6
    7
    &gt;&gt;&gt; for num in iterator:
    ...     print(num)
    2
    3
    4
    5
    6
    7
    &quot;&quot;&quot;
    def __init__(self, start, end):
        "*** YOUR CODE HERE ***"

    def __next__(self):
        "*** YOUR CODE HERE ***"

    def __iter__(self):
        "*** YOUR CODE HERE ***"</code></pre>

</solution>

<p>Use OK to test your code:</p><pre><code>python3 ok -q IteratorRestart</code></pre>


<h2 id="generators">Generators</h2>


<p>A generator function returns a special type of <strong>iterator</strong> called
a <strong>generator</strong> object. Such functions can be written using a <code>yield</code>
statement:</p>

<pre><code>def &lt;generator_fn_name&gt;():
    &lt;somevariable&gt; = &lt;something&gt;
    while &lt;predicate&gt;:
        yield &lt;something&gt;
        &lt;increment somevariable&gt;</code></pre>

<p>Calling a generator function (a function with a yield statement in it)
makes it return a generator object rather than executing the body of
the function.</p>

<p>The reason we say a generator object is  a special type of <strong>iterator</strong>
is that it has all the properties of an iterator, meaning that:</p>

<ul>
  <li>Calling the <code>__iter__</code> method makes a generator object return
  itself without modifying its current state.</li>
  <li>Calling the <code>__next__</code> method makes a generator object compute and
  return the next object in its sequence. If the sequence is
  exhausted, <code>StopIteration</code> is raised.</li>
  <li>Typically, a generator should not restart unless it's defined that way. But
  calling the generator function returns a brand new generator object (like
  calling <code>__iter__</code> on an iterable object).</li>
</ul>

<p>However, they do have some fundamental differences:</p>

<ul>
  <li>An iterator is a class with <code>__next__</code> and <code>__iter__</code> explicitly defined, but
  a generator can be written as a mere function with a <code>yield</code> in it.</li>
  <li><code>__iter__</code> in an iterator uses <code>return</code>, but a generator uses <code>yield</code>.</li>
  <li><p>A generator "remembers" its state for the next <code>__next__</code> call. Therefore, the
  first <code>__next__</code> call works like this:</p>

  <ol>
    <li>Enter the function, run until the line with <code>yield</code>.</li>
    <li>Return the value in the <code>yield</code> statement, but remember the state of the
    function for future <code>__next__</code> calls.</li>
  </ol>

  <p>And subsequent <code>__next__</code> calls work like this:</p>

  <ol>
    <li>Re-enter the function, start at <strong>the line after <code>yield</code></strong>, and run until
    the next <code>yield</code> statement.</li>
    <li>Return the value in the <code>yield</code> statement, but remember the state of the
    function for future <code>__next__</code> calls.</li>
  </ol></li>
</ul>

<blockquote><p>Use OK to test your knowledge with the following What would Python print
questions:</p>

<pre><code>python3 ok &#x2d;q generators &#x2d;u &#x2d;&#x2d;local</code></pre></blockquote>

<pre><code>def generator():
    print(&quot;Starting here&quot;)
    i = 0
    while i &lt; 6:
        print(&quot;Before yield&quot;)
        yield i
        print(&quot;After yield&quot;)
        i += 1</code></pre>

<prompt>

<pre><code>&gt;&gt;&gt; g = generator()
&gt;&gt;&gt; g # what type of object is this?
&lt;generator object ...&gt;
&gt;&gt;&gt; g == iter(g) # equivalent of g.__iter__()
True
&gt;&gt;&gt; next(g) # equivalent of g.__next__()
Starting here
Before yield
0
&gt;&gt;&gt; next(g)
After yield
Before yield
1
&gt;&gt;&gt; next(g)
After yield
Before yield
2</code></pre>

</prompt>

<p>Trace through the code and make sure you know where and why each
statement is printed.</p>

<p>You might have noticed from the Iterators section that <code>IteratorB</code>, which didn't
define a <code>__next__</code> method, failed to run in the <code>for</code> loop.  However, this is
not always the case.</p>

<pre><code>class IterGen:
    def __init__(self):
        self.start = 5

    def __iter__(self):
        while self.start &lt; 10:
            self.start += 1
            yield self.start

for i in IterGen():
    print(i)</code></pre>

<p>Why does this iterable work without defining a <code>__next__</code> method?</p>

<p>The <code>for</code> loop only expects the object returned by <code>__iter__</code> to have a
<code>__next__</code> method. The <code>__iter__</code> method is a generator function because of the
<code>yield</code> statement in the body. Therefore, when <code>__iter__</code> is called, it returns
a generator object, which you can call <code>__next__</code> on.</p>

<h3 class="question" id="q2">Question 2: Merge</h3>

<p>Implement <code>merge(s0, s1)</code>, which takes two iterables <code>s0</code> and <code>s1</code> whose
elements are ordered. <code>merge</code> yields elements from <code>s0</code> and <code>s1</code> in sorted
order, eliminating repetition. <strong>You may also assume <code>s0</code> and <code>s1</code> represent infinite
sequences; that is, their iterators never raise <code>StopIteration</code></strong>.</p>

<p>See the doctests for example behavior.</p>

<solution>

<pre><code>def merge(s0, s1):
    &quot;&quot;&quot;Yield the elements of strictly increasing iterables s0 and s1 and 
    make sure to remove the repeated values in both. 
    You can also assume that s0 and s1 represent infinite sequences.

    &gt;&gt;&gt; twos = scale(naturals(), 2)
    &gt;&gt;&gt; threes = scale(naturals(), 3)
    &gt;&gt;&gt; m = merge(twos, threes)
    &gt;&gt;&gt; type(m)
    &lt;class &#x27;generator&#x27;&gt;
    &gt;&gt;&gt; [next(m) for _ in range(10)]
    [2, 3, 4, 6, 8, 9, 10, 12, 14, 15]
    &quot;&quot;&quot;
    i0, i1 = iter(s0), iter(s1)
    e0, e1 = next(i0), next(i1)
    "*** YOUR CODE HERE ***"</code></pre>

</solution>

<p>Use OK to test your code:</p><pre><code>python3 ok -q merge</code></pre>


<h2 id="sql">SQL</h2>



<h2 id="working-with-the-chinook-dataset">Working with the Chinook Dataset</h2>


<p>The <a href="https://chinookdatabase.codeplex.com/wikipage?title=Chinook_Schema&referringTitle=Documentation">Chinook dataset</a> is a sample dataset that you'll be working with in this homework. It contains data about many different musical albums, as well as the tracks and musical artists on those albums. To simplify things, we've only given you the <code>artists</code>, <code>albums</code>, and <code>tracks</code> tables (note that this means that some columns in the <code>tracks</code> table, such as <code>genreId</code> and <code>mediaTypeId</code> won't reference anything). We've also cleaned up the data for you and truncated the <code>tracks</code> table (it used to be several thousand records long!). Let's take a look at the different tables we've given you:</p>

<ol>
  <li><p><code>artists</code></p>

  <ul>
    <li><code>artistId</code>: the unique ID number assigned to this artist</li>
    <li><code>name</code>: the name of this artist</li>
  </ul></li>
  <li><p><code>albums</code></p>

  <ul>
    <li><code>albumId</code>: the unique ID number assigned to this album</li>
    <li><code>title</code>: the title of this album</li>
    <li><code>artistId</code>: the unique ID of the artist on this album</li>
  </ul></li>
  <li><p><code>tracks</code></p>

  <ul>
    <li><code>trackId</code>: the unique ID number assigned to this track</li>
    <li><code>name</code>: the name of this track</li>
    <li><code>albumId</code>: the unique ID of the album that this track is on</li>
    <li><code>mediaTypeId</code>: don't worry about this!</li>
    <li><code>genreId</code>: don't worry about this!</li>
    <li><code>composer</code>: the composer of this track</li>
    <li><code>milliseconds</code>: the length of this track in milliseconds</li>
    <li><code>bytes</code>: the size of this track file in bytes</li>
    <li><code>unitPrice</code>: the price of this track</li>
  </ul></li>
</ol>

<p>You will write all of your solutions in the starter file provided. As with other
labs, you can test your solutions with OK. In addition, you can use either of
the following commands. You may need to refer to the Usage section to find the
appropriate command for your OS:</p>

<pre><code>sqlite3 &lt; hw12.sql
sqlite3 &#x2d;&#x2d;init hw12.sql</code></pre>

<h3 class="question" id="q3">Question 3: What Would SQL print?</h3>

<p>First, load the tables into sqlite3. If you're on Windows or Mac OS X
(Mavericks or older), use the following command:</p>

<pre><code>$ ./sqlite3 &#x2d;&#x2d;init hw12.sql</code></pre>

<p>If you're on Ubuntu or Mac OS X (Yosemite or newer), use:</p>

<pre><code>$ sqlite3 &#x2d;&#x2d;init hw12.sql</code></pre>

<p>Before we start, inspect the schema of the tables that we've created for you:</p>

<pre><code>sqlite&gt; .schema</code></pre>

<p>This tells you the name of each of our tables and their attributes.</p>

<p>Let's also take a look at some of the entries in our table. There are a lot of
entries though, so let's just output the first 20:</p>

<pre><code>sqlite&gt; SELECT * FROM tracks LIMIT 20;</code></pre>

<p>If you're curious about which artists/albums/tracks we've included,
open up <code>chinook.sql</code> in your favorite text editor and take a look!</p>

<p>For each of the SQL queries below, decide to yourself and/or your partner what the
query is looking for, then try running the query yourself and see!</p>

<prompt>

<pre><code>sqlite&gt; SELECT * FROM artists; &#x2d;&#x2d; This is a comment. * is shorthand for all columns!
selects all records from artists;
sqlite&gt; SELECT name FROM tracks WHERE bytes &gt; 3000000; &#x2d;&#x2d; There are 1000000 bytes in a megabyte.
selects the name of all tracks that are larger than 3 Mb
sqlite&gt; SELECT name, composer FROM tracks WHERE albumId = 57 AND milliseconds &gt; 180000; &#x2d;&#x2d; How many milliseconds are in a minute?
selects the name and composer of all tracks longer than 3 minutes on the album with albumID = 57</code></pre>

</prompt>

<h3 class="question" id="q4">Question 4: Get rid of the fluff!</h3>

<p>Write a SQL query to create a table that contains just the <code>name</code> and <code>unitPrice</code>
of each track in the <code>tracks</code> table.</p>

<p>You should get the following output:</p>

<pre><code>sqlite&gt; SELECT * FROM pricing LIMIT 10;
For Those About To Rock (We Salute You)|0.99
Fast As a Shark|0.99
Restless and Wild|0.99
Princess of the Dawn|0.99
Put The Finger On You|0.99
Let&#x27;s Get It Up|0.99
Inject The Venom|0.99
Snowballed|0.99
Evil Walks|0.99
C.O.D.|0.99</code></pre>

<solution>

<pre><code>CREATE TABLE pricing as
  select "REPLACE THIS LINE WITH YOUR SOLUTION";</code></pre>

</solution>

<p>Use OK to test your code:</p><pre><code>python3 ok -q pricing</code></pre>

<h3 class="question" id="q5">Question 5: Long songs...</h3>

<p>Now that we have learned how to select columns from a SQL table, let's filter the
results to see some more interesting results!</p>

<p>Write a SQL query to create a table that contains the names of all tracks longer
than 6 minutes (that's a long song!)</p>

<p>You should get the following output:</p>

<pre><code>sqlite&gt; SELECT * FROM long LIMIT 10;
Princess of the Dawn
Let There Be Rock
Overdose
Livin&#x27; On The Edge
You Oughta Know (Alternate)
Love, Hate, Love
Master Of Puppets
Harvester Of Sorrow
Wherever I May Roam
Snoopy&#x27;s search&#x2d;Red baron</code></pre>

<solution>

<pre><code>CREATE TABLE long as
  select "REPLACE THIS LINE WITH YOUR SOLUTION";</code></pre>

</solution>

<p>Use OK to test your code:</p><pre><code>python3 ok -q long</code></pre>

<h3 class="question" id="q6">Question 6: Biggest Song</h3>

<p>Which song takes up the most space (as a file)? Let's find out! (Incidentally
this is also the longest song in our database.)</p>

<p>Write a SQL query with the columns <code>name</code> and <code>milliseconds</code> to try to determine what the largest song file is. In order to make it
easier for us to inspect these values, use <a href="http://www.tutorialspoint.com/sql/sql-order-by.htm"><code>ORDER BY</code></a> to sort the numerical values
and <code>LIMIT</code> your result to just the biggest track.</p>

<p>You should get the following output:</p>

<pre><code>sqlite&gt; SELECT * FROM largest;
How Many More Times|711836</code></pre>

<solution>

<pre><code>CREATE TABLE largest as
  select "REPLACE THIS LINE WITH YOUR SOLUTION";</code></pre>

</solution>

<p>Use OK to test your code:</p><pre><code>python3 ok -q largest</code></pre>


<h2 id="joins">Joins</h2>


<p>We can use <em>joins</em> to include rows from another table that satisfy the where
predicate. Joins can either be on different tables, or the same table if we
include an alias. Here we are referencing the football table twice, once as
the alias <code>a</code> and once as the alias <code>b</code>.</p>

<pre><code>sqlite&gt; SELECT a.Berkeley &#x2d; b.Berkeley, a.Stanford &#x2d; b.Stanford, a.Year, b.Year
...&gt;        FROM Football as a, Football as b WHERE a.Year &gt; b.Year;
&#x2d;11|22|2014|2003
&#x2d;13|21|2014|2002
&#x2d;2|9|2003|2002</code></pre>

<p>What is this query asking for?</p>

<p>You may notice that it does not seem like we actually performed any operations
to do the join. However, the join is implicit in the fact that we listed more
than one table after the FROM. In this example, we joined the table <code>Football</code>
with itself and gave each instance of the table an alias, <code>a</code> and <code>b</code> so that
we could distinctly refer to each table's attributes and perform selections and
comparisons on them, such as <code>a.Year &gt; b.Year</code>.</p>

<p>One way to think of a join is that it produces a cross-product between the two
tables by matching each row from the first table with every other row in the
second table, which creates a new, larger joined table.</p>

<p>Here's an illustration of what happened in the joining process during the
above query.</p>

<p><img class="img-responsive center-block" src="assets/joins.png" alt="joins"></p>

<p>From here, the select statement examines the joined table and selects the values
it desires: <code>a.Berkeley &#x2d; b.Berkeley</code> and <code>a.Stanford &#x2d; b.Stanford</code> but only
from the rows <code>WHERE a.Year &gt; b.Year</code>. This prevents duplicate results from
appearing in our output!</p>

<h3 class="question" id="q7">Question 7: Long songs on albums</h3>

<p>We know which songs are long, but now we want to know which albums have long
songs on them!</p>

<p>Write a SQL query to create a table that contains the titles of all albums
with tracks longer than 6 minutes on them.</p>

<p>You should get the following output:</p>

<pre><code>sqlite&gt; SELECT * FROM long_album LIMIT 10;
Restless and Wild
Let There Be Rock
Let There Be Rock
Big Ones
Jagged Little Pill
Facelift
Plays Metallica By Four Cellos
Plays Metallica By Four Cellos
Plays Metallica By Four Cellos
The Best Of Billy Cobham</code></pre>

<p>Note that albums can appear more than once in this table. Why is this? What does
the number of times an album appears tell you?</p>

<solution>

<pre><code>CREATE TABLE long_album as
  select "REPLACE THIS LINE WITH YOUR SOLUTION";</code></pre>

</solution>

<p>Use OK to test your code:</p><pre><code>python3 ok -q long_album</code></pre>


<h2 id="aggregate-functions">Aggregate Functions</h2>


<p>So far, we haven't given you a good way of counting the number of rows that fit
certain criteria.</p>

<p>Bring in SQL aggregation, which is commonly used to aggregate values in order to answer these
types of questions!</p>

<p>In order to perform SQL aggregation, we need to group rows in our table by one or more attributes. Once
we have groups, we can aggregate over the groups in our table and find things like the maximum value (<code>MAX</code>),
the minimum value (<code>MIN</code>), the number of rows in the group (<code>COUNT</code>), the average over all of the values
(<code>AVG</code>), and more! <code>SELECT</code> statements that use aggregation are marked by two things: an aggregate function
(<code>MAX</code>, <code>MIN</code>, <code>COUNT</code>, <code>AVG</code>, etc.) and a <code>GROUP BY</code> clause. For example, if we wanted to see how many
tracks are on each album (identified by albumId):</p>

<pre><code>sqlite&gt; SELECT albumId, max(milliseconds) FROM tracks GROUP BY albumId LIMIT 10;
1|343719
3|375418
4|369319
5|381231
6|491885
7|387134
9|436453
10|343457
11|309786
12|163265</code></pre>

<p>So the longest song on the album with albumId 57 is 343719 ms long!</p>

<p>This <code>SELECT</code> statement groups all of the rows in our table <code>tracks</code> by <code>albumId</code>. Then, within each
group, we perform aggregation by MAXing over the attribute <code>milliseconds</code>. By selecting <code>albumId</code> and <code>MAX(milliseconds)</code>,
we then can see the greatest <code>milliseconds</code> for any track for a given <code>albumId</code>.</p>

<blockquote><p>When using an aggregate function in your <code>SELECT</code> statement, any other columns in the <code>SELECT</code> statement <em>must</em> be in the <code>GROUP BY</code> statement!</p></blockquote>

<h3 class="question" id="q8">Question 8: Number of songs on each album</h3>

<p>Write a SQL query to create a table that contains the <code>albumId</code> and number of songs
on the album with that albumId. HINT: Remember that <code>count(*)</code> will count the
number of rows in each group of a <code>GROUP BY</code> statement.</p>

<p>You should get the following output:</p>

<pre><code>sqlite&gt; SELECT * FROM track_count LIMIT 10;
1|10
3|3
4|8
5|15
6|13
7|12
9|8
10|14
11|12
12|12</code></pre>

<solution>

<pre><code>CREATE TABLE track_count as
  select "REPLACE THIS LINE WITH YOUR SOLUTION";</code></pre>

</solution>

<p>Use OK to test your code:</p><pre><code>python3 ok -q track_count</code></pre>

<h3 class="question" id="q9">Question 9: Counting albums</h3>

<p>So far, we haven't yet considered the <code>artists</code> table. What if we want to know
how many albums each artist has released?</p>

<p>Write a SQL query to create a table that contains the name of each artist along
with how many albums that artist has released (that are in the <code>albums</code> table).</p>

<p>You should get the following output:</p>

<pre><code>sqlite&gt; SELECT * FROM album_count LIMIT 10;
Aaron Copland &amp; London Symphony Orchestra|1
Aaron Goldberg|1
Academy of St. Martin in the Fields &amp; Sir Neville Marriner|1
Academy of St. Martin in the Fields Chamber Ensemble &amp; Sir Neville Marriner|1
Academy of St. Martin in the Fields, John Birch, Sir Neville Marriner &amp; Sylvia McNair|1
Academy of St. Martin in the Fields, Sir Neville Marriner &amp; Thurston Dart|1
Accept|2
Adrian Leaper &amp; Doreen de Feis|1
Aerosmith|1</code></pre>

<solution>

<pre><code>CREATE TABLE album_count as
  select "REPLACE THIS LINE WITH YOUR SOLUTION";</code></pre>

</solution>

<p>Use OK to test your code:</p><pre><code>python3 ok -q album_count</code></pre>

<h3 class="question" id="q10">Question 10: Busiest artists</h3>

<p>How many songs have each artist produced? Write a SQL query to create a table
containing artists' names and the number of tracks that they're produced
(we'll assume an artist produced a track if it appears on one of their albums).</p>

<p>HINT: You may need all three tables!</p>

<p>You should get the following output:</p>

<pre><code>sqlite&gt; SELECT * FROM busiest_artists LIMIT 10;
AC/DC|18
Accept|3
Aerosmith|15
Alanis Morissette|13
Alice In Chains|12
Antônio Carlos Jobim|17
Apocalyptica|8
Audioslave|26
BackBeat|12
Billy Cobham|8</code></pre>

<solution>

<pre><code>CREATE TABLE busiest_artists as
  select "REPLACE THIS LINE WITH YOUR SOLUTION";</code></pre>

</solution>

<p>Use OK to test your code:</p><pre><code>python3 ok -q busiest_artists</code></pre>

<p>Note that computing a join over all three tables is very expensive! To see how
many rows are considered, run the following query:</p>

<p><code>
SELECT count(*) FROM artists, albums, tracks;
</code></p>

<p>There may be a slight delay (because you're computing so many different candidate rows!).</p>


  </div>

  <div class='col-md-3'>
    <nav class='hidden-print hidden-sm hidden-xs sidebar'>
      <ul>
  <li><a href="#iterators">Iterators</a></li>
  <ul>
  <li><a href="#q1">Question 1: Restart</a></li>
</ul>

  <li><a href="#generators">Generators</a></li>
  <ul>
  <li><a href="#q2">Question 2: Merge</a></li>
</ul>

  <li><a href="#sql">SQL</a></li>
  <li><a href="#working-with-the-chinook-dataset">Working with the Chinook Dataset</a></li>
  <ul>
  <li><a href="#q3">Question 3: What Would SQL print?</a></li>
  <li><a href="#q4">Question 4: Get rid of the fluff!</a></li>
  <li><a href="#q5">Question 5: Long songs...</a></li>
  <li><a href="#q6">Question 6: Biggest Song</a></li>
</ul>

  <li><a href="#joins">Joins</a></li>
  <ul>
  <li><a href="#q7">Question 7: Long songs on albums</a></li>
</ul>

  <li><a href="#aggregate-functions">Aggregate Functions</a></li>
  <ul>
  <li><a href="#q8">Question 8: Number of songs on each album</a></li>
  <li><a href="#q9">Question 9: Counting albums</a></li>
  <li><a href="#q10">Question 10: Busiest artists</a></li>
</ul>

</ul>

    </nav>
  </div>

</div>
    </div>
    <script src="//cdn.jsdelivr.net/jquery/2.1.3/jquery.min.js"></script>
    <script src="/fa19/assets/js/bootstrap.min.js"></script>
    <!-- TODO: Move to specific pages... -->
    <script src="/fa19/assets/js/highlight.pack.js"></script>
    <script>hljs.initHighlightingOnLoad();</script>

    <script>
  $('.sidebar ul').addClass('nav nav-stacked');
  $('body').scrollspy({
    target: '.sidebar',
    offset: 40
  });
</script>

  </body>
</html>
